<div class="container" id="webapp">
    <div class="row">
        <div id="home-cards" class="card-container">
            {% for dish in site.data.piatti %}
            <div id="dish-{{ dish.id }}-card" class="card" data-toggle="modal" data-target="#dish-{{dish.id}}"
                 style="cursor: pointer">
                <div class="card-img">
                    {% if dish.immagine == "/assets/images/carbonara.jpg" %}
                    <img src="{{site.baseurl}}{{dish.immagine}}" class="card-img-top" alt="{{ dish.nome }}">
                    {% else %}
                    <img src="{{site.baseurl}}/assets/images/placeholder_squared.png" class="card-img-top"
                         alt="{{ dish.nome }}">
                    {% endif %}
                    <div class="dish-title">
                        <h5>{{ dish.nome }}</h5>
                    </div>
                </div>
            </div>

            <div class="modal fade bd-example-modal-lg" id="dish-{{dish.id}}" tabindex="-1" role="dialog"
                 aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <div style="font-family:'Oswald';"><span
                                    style="text-transform: uppercase; font-size: 1.25rem; font-weight: 500"
                                    class="modal-title ml-3"
                                    id="exampleModalLongTitle">{{dish.nome}}</span> - ecco i migliori ristoranti a Roma
                            </div>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body py-3">
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-6">

                                        {% assign restaurants = site.data[dish.id] %}
                                        {% if restaurants %}
                                        {% assign restaurants_sorted = restaurants | sort: 'N_5_stars' | reverse %}
                                        {% for restaurant in restaurants_sorted %}
                                        <div class="container webapp-modal">
                                            <div class="row">
                                                <div class="col-12">
                                                    <div class="accordion" id="accordion-{{restaurant.id}}">
                                                        <div class="card">
                                                            <div class="card-header" id="heading-{{restaurant.id}}">
                                                                <div class="my-0">
                                                                    <button class="btn btn-link btn-block text-left"
                                                                            type="button"
                                                                            data-toggle="collapse"
                                                                            data-target="#restaurant-{{restaurant.id}}"
                                                                            aria-expanded="true"
                                                                            aria-controls="{{restaurant.id}}">
                                                            <span class="badge badge-primary">{{restaurant.N_5_stars}}  <i
                                                                    class="fa-solid fa-star"></i> </span>
                                                                        <span class="r-title">{{restaurant.name}}</span>
                                                                        <span class="hamburger">
                                                                <i class="fa-solid fa-bars"></i>
                                                            </span>
                                                                        <span class="cost">{{restaurant.price_range}}</span>

                                                                    </button>
                                                                </div>
                                                            </div>

                                                            <div id="restaurant-{{restaurant.id}}"
                                                                 class="collapse px-4 pt-3"
                                                                 aria-labelledby="{{restaurant.name}}"
                                                                 data-parent="#accordion-{{restaurant.id}}">
                                                                <div class="card-body">
                                                                    <p>
                                                                        <i class="fa-solid fa-map-marker-alt"></i>
                                                                        <em>{{restaurant.address}}</em>
                                                                    </p>
                                                                    <p>
                                                                        <i class="fa-solid fa-phone"></i>
                                                                        <em>{{restaurant.tel}}</em>
                                                                    </p>

                                                                    {% if restaurant.hours %}
                                                                    {% assign orari = restaurant.hours %}
                                                                    {% assign orari = orari | replace: "{", "" |
                                                                    replace: "}",
                                                                    "" |
                                                                    replace: "'", "" %}
                                                                    {% assign orari = orari | split: ", " %}
                                                                    <div class="orari" style="font-size:0.8rem">
                                                                        <hr>
                                                                        {% for orario in orari %}
                                                                        {% assign giorno_valori = orario | split: ": "
                                                                        %}
                                                                        {% assign giorno = giorno_valori[0] %}
                                                                        {% assign valori = giorno_valori[1] | replace:
                                                                        "[", "" |
                                                                        replace: "]", "" %}
                                                                        <strong>{{ giorno }}:</strong> {{ valori }}

                                                                        {% endfor %}
                                                                    </div>
                                                                    {% endif %}

                                                                    {% if restaurant.description %}
                                                                    <hr>
                                                                    <p>{{restaurant.description}}</p>
                                                                    {% endif %}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        {% endfor %}
                                        {% else %}
                                        <p>Il dataset per '{{ dish.nome }}' non esiste o Ã¨ vuoto.</p>
                                        {% endif %}
                                    </div>
                                    <div class="col-md-6">
                                        <div class="map">
                                            <iframe style="width: 100%; height: 486px;"
                                                    src="{{site.baseurl}}{{dish.mappa}}">
                                            </iframe>
                                            <p class="text-center pt-2">Mappa dei ristoranti a Roma dove mangiare
                                                {{dish.nome}}</p>
                                            <hr>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Chiudi</button>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <style>
            .card-container .card {
                flex: 1 1 calc(20% - 1rem);
                max-width: calc(100% - 1rem);
            }

            .card-header {
                padding: 0.25rem 0.5rem;
            }

            .cost {
                float: right;
                font-size: 0.8rem;
                color: #b3b3b3;
                margin-right: 1rem;
            }

            .badge {
                font-size: 0.9rem;
                margin-right: 0.5rem;
            }

            .hamburger {
                float: right;
                font-size: 0.8rem;
                color: #b3b3b3;
            }

            map {
                height: 480px;
                width: 100%;
            }

            .modal-content {
                background-color: #f0fff0;
            }

            .modal-header {
                background-color: #7ac2ae;
            }

            .modal-footer {
                background-image: url('{{site.baseurl}}/assets/images/header.png');
                background-color: #7ac2ae;
            }

            .dish-title h5 {
                text-transform: unset !important;
                margin-top: 0.5rem;
                font-weight: 200;
            }

            .card:hover {
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
                border: 1px solid #b3b3b3;
            }

            .r-title {
                color: #666666;
                text-decoration: none;
            }
        </style>
    </div>
</div>